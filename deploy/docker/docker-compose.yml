version: '3.8'

services:
  # Rust Chat Server with native TLS support
  chat_server:
    build:
      context: ../..
      dockerfile: deploy/docker/Dockerfile
    container_name: rust_chat_server
    restart: unless-stopped
    environment:
      - CHAT_SERVER_ADDR=0.0.0.0:8443
      - CHAT_SERVER_MAX_CLIENTS=100
      # TLS configuration (mount certificates as volumes)
      - TLS_CERT_PATH=/certs/fullchain.pem
      - TLS_KEY_PATH=/certs/privkey.pem
    ports:
      # TLS-encrypted chat port
      - "8443:8443"
    volumes:
      # Mount your TLS certificates here
      # Update the paths to point to your actual certificates
      - ./certs:/certs:ro
    networks:
      - chat_network

networks:
  chat_network:
    driver: bridge
